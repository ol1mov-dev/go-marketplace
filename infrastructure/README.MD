# Kafka Docker Setup

–õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Apache Kafka —Å Zookeeper –∏ Kafka UI —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
- [–ü–æ—Ä—Ç—ã](#–ø–æ—Ä—Ç—ã)
- [Troubleshooting](#troubleshooting)

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker 20.10+
- Docker Compose 1.29+ (–∏–ª–∏ Docker Compose V2)
- –ú–∏–Ω–∏–º—É–º 4GB RAM
- –°–≤–æ–±–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã: 2181, 9092, 29092, 8080

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ docker-compose.yml    # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ config.yaml          # –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üê≥ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Zookeeper
- **–í–µ—Ä—Å–∏—è**: 7.5.0
- **–ü–æ—Ä—Ç**: 2181
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –¥–ª—è Kafka –∫–ª–∞—Å—Ç–µ—Ä–∞

### Kafka
- **–í–µ—Ä—Å–∏—è**: 7.5.0
- **–ü–æ—Ä—Ç—ã**:
    - 9092 (–≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø)
    - 29092 (–≤–Ω—É—Ç—Ä–∏–∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–π)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π Apache Kafka

### Kafka UI
- **–í–µ—Ä—Å–∏—è**: latest
- **–ü–æ—Ä—Ç**: 8080
- **–û–ø–∏—Å–∞–Ω–∏–µ**: Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Kafka

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8080

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å Kafka UI —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º –∫–ª–∞—Å—Ç–µ—Ä–æ–º `local`.

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### config.yaml

–°–æ–¥–µ—Ä–∂–∏—Ç –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (–æ–±—Ä–∞–∑—ã, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, volumes). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.

### docker-compose.yml

–°–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞:
- –ò–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ü–æ—Ä—Ç—ã
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –ù–∞—Å–ª–µ–¥—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ `config.yaml`

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Kafka

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|----------|
| `KAFKA_BROKER_ID` | 1 | ID –±—Ä–æ–∫–µ—Ä–∞ |
| `KAFKA_ZOOKEEPER_CONNECT` | zookeeper:2181 | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Zookeeper |
| `KAFKA_ADVERTISED_LISTENERS` | PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092 | –ê–¥—Ä–µ—Å–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è |
| `KAFKA_AUTO_CREATE_TOPICS_ENABLE` | true | –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤ |

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞

```bash
docker exec -it kafka kafka-topics --create \
  --topic my-topic \
  --bootstrap-server localhost:9092 \
  --partitions 3 \
  --replication-factor 1
```

### –°–ø–∏—Å–æ–∫ —Ç–æ–ø–∏–∫–æ–≤

```bash
docker exec -it kafka kafka-topics --list \
  --bootstrap-server localhost:9092
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

```bash
docker exec -it kafka kafka-console-producer \
  --topic my-topic \
  --bootstrap-server localhost:9092
```

### –ß—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

```bash
docker exec -it kafka kafka-console-consumer \
  --topic my-topic \
  --from-beginning \
  --bootstrap-server localhost:9092
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```python
# Python (kafka-python)
from kafka import KafkaProducer

producer = KafkaProducer(bootstrap_servers='localhost:9092')
producer.send('my-topic', b'Hello Kafka!')
```

```javascript
// Node.js (kafkajs)
const { Kafka } = require('kafkajs');

const kafka = new Kafka({
  clientId: 'my-app',
  brokers: ['localhost:9092']
});
```

```java
// Java
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");

KafkaProducer<String, String> producer = new KafkaProducer<>(props);
```

## üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ó–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose up -d

# –ó–∞–ø—É—Å–∫ —Å –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º –ª–æ–≥–æ–≤
docker-compose up
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º volumes (–£–î–ê–õ–ò–¢ –í–°–ï –î–ê–ù–ù–´–ï!)
docker-compose down -v
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose restart

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart kafka
```

### –õ–æ–≥–∏

```bash
# –í—Å–µ –ª–æ–≥–∏
docker-compose logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f kafka

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker-compose logs --tail=100 kafka
```

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±—Ä–æ–∫–µ—Ä–æ–≤ Kafka (—Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
docker-compose up -d --scale kafka=3
```

## üîå –ü–æ—Ä—Ç—ã

| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------|------------|
| Zookeeper | 2181 | Client port |
| Kafka | 9092 | –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø (PLAINTEXT_HOST) |
| Kafka | 29092 | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø (PLAINTEXT) |
| Kafka UI | 8080 | Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |

## üîç Troubleshooting

### Kafka –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs kafka

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ Zookeeper
docker-compose ps zookeeper

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart
```

### –û—à–∏–±–∫–∞ "Address already in use"

–ü–æ—Ä—Ç—ã —É–∂–µ –∑–∞–Ω—è—Ç—ã. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤ `docker-compose.yml`:

```yaml
ports:
  - "9093:9092"  # –ò–∑–º–µ–Ω–∏—Ç–µ –≤–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç
```

### –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏

–£–≤–µ–ª–∏—á—å—Ç–µ –ø–∞–º—è—Ç—å –¥–ª—è Docker (Docker Desktop ‚Üí Settings ‚Üí Resources ‚Üí Memory).

### Kafka UI –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
docker exec -it kafka-ui env | grep KAFKA

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Kafka UI
docker-compose restart kafka-ui
```

### –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
docker-compose down -v

# –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
docker-compose down --rmi all

# –ù–æ–≤—ã–π –∑–∞–ø—É—Å–∫
docker-compose up -d
```